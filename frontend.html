<html>
    <head>
        <title>first delivrable</title>
        <style>  /*CSS*/
            /*droped down menu*/
            .collapsible {
            background-color: #777;
            color: white;
            cursor: pointer;
            padding: 18px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 15px;
            }

            .active, .collapsible:hover {
            background-color: #555;
            }

            .content {
            padding: 0 18px;
            display: none;
            overflow: hidden;
            background-color: #f1f1f1;
            }
            input[type=text], select {
            width: 100%;
            padding: 12px 20px;
            margin: 8px 0;
            display: inline-block;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            }

            /*submit button*/
            input[type=submit] {
            width: 100%;
            background-color: #696969;
            color: white;
            padding: 14px 20px;
            margin: 8px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            }

            input[type=submit]:hover {
            background-color: #808080;
            }

            div {
            border-radius: 5px;
            background-color: #f2f2f2;
            padding: 20px;
            }
        </style>  
    </head>
    <body>
        <link rel="shortcut icon" href=""> <!-- to fix favicon.ico err-->
        <p><b class="textinparagraph"> Welcome to this awsome book website!!!</b>
        </p>
        <button id="button1" type="button" class="collapsible">Add new book</button>
        <div class="content">
            <form action="/action_page.php">
                <label for="author">author</label>
                <input id="author" type="text" name="text" placeholder="author">

                <label for="title">title</label>
                <input id="title" type="text" name="text" placeholder="title">

                <label for="genre">genre</label>
                <form>
                    <select id="genre" name="genre">
                        <option selected="true" disabled="disabled">Select a genre</option>   
                        <option value="Science fiction">Science fiction</option>
                        <option value="Satire">Satire</option>
                        <option value="Drama">Drama</option>
                        <option value="Action and Adventure">Action and Adventure</option>
                        <option value="Romance">Romance</option>
                        <option value="Mystery">Mystery</option>
                        <option value="Horror">Horror</option>
                    </select>
                </form>

                <label for="price">price</label>
                <input id="price" type="text" name="text" placeholder="price">

                <input id="addbook" type="submit" value="Submit">
            </form>
        </div>
        <button id="button2" type="button" class="collapsible">search book</button>
        <div class="content">
            <input type="text" name="text" placeholder="type a keyword for the book you are lookign for">
            <form action="/action_page.php">
                <input id="search" type="submit" value="search">
            </form>
        </div>
    </body>

    <script type="text/javascript">
		// collapsable buttons 
        var coll = document.getElementsByClassName("collapsible");
		for (var i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.display === "block") {
                    content.style.display = "none";
                } else {
                    content.style.display = "block";
                }
            });
        }


		// the add new book button
		document.getElementById('addbook').addEventListener('click', function(event){
            const xhr=new XMLHttpRequest();
            xhr.open('post', 'http://localhost:3000/addBook');
            xhr.setRequestHeader('Content-Type','application/json');
            const book = {
                author: document.getElementById('author').value,
                title: document.getElementById('title').value,
                genre: document.getElementById('genre').value,
                price: document.getElementById('price').value
            };
            xhr.send(JSON.stringify(book));
            xhr.onreadystatechange = function(){
                if (xhr.readyState == 4){
                    var price = document.getElementById("price");
                    if (xhr.status == 200){
                        if (isNaN(price)){
                            alert('price must be a number');
                        }else{
                            alert('ok');
                        }

                    }
                }    
            };
        });

        // search button

         const submit = document.getElementById('submit');
         submit.addEventListener('click',function(event){
             const xhr = new XMLHttpRequest();
             xhr.open('GET','http://localhost:3000/getBooks');
             xhr.send();
             xhr.onreadystatechange = function(){
                 if (xhr.readyState== 4){
                     if (xhr.status == 200){
                         const result = JSON.parse(xhr.responseText);
                         const pElem = document.createElement('p');
                         const text = document.createTextNode(author);
                         pElem.appendChild(text);
                         const divElem = document.getElementById('author');
                         divElem.appendChild(pElem);
                         alert(author);
                     }
                 }
             }
         });
    </script>
</html>